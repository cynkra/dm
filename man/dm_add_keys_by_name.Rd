% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/dm-add-keys-by-name.R
\name{dm_add_keys_by_name}
\alias{dm_add_keys_by_name}
\title{Infer and add keys based on column name equality}
\usage{
dm_add_keys_by_name(dm, ..., quiet = FALSE)
}
\arguments{
\item{dm}{A \code{dm} object.}

\item{...}{These dots are for future extensions and must be empty.}

\item{quiet}{If \code{TRUE}, suppresses messages about added keys.}
}
\value{
An updated \code{dm} with inferred primary and foreign keys added.
}
\description{
\code{dm_add_keys_by_name()} automatically infers primary and foreign key
relationships by finding columns with identical names across tables.
For each shared column name, if exactly one table has unique values
(potential primary key) and other tables have non-unique values
(potential foreign keys), the relationships are established.
}
\details{
The function works by:
\enumerate{
\item Finding columns that appear in multiple tables
\item For each shared column, checking which tables have unique values
\item If exactly one table has unique values and others don't, it adds:
\itemize{
\item A primary key to the table with unique values
\item Foreign keys from tables with non-unique values
}
}

This is particularly useful for datasets that follow naming conventions
like ADaM (Analysis Data Model) in pharmaceutical research, where
\code{USUBJID} (subject ID) appears across multiple tables and is unique
in the subject-level table (ADSL) but not in other tables.

Columns where all tables have unique values (ambiguous PK) or no table
has unique values (no valid PK candidate) are skipped.
}
\examples{
\dontshow{if (rlang::is_installed("DiagrammeR")) withAutoprint(\{ # examplesIf}
# Create tables with a shared column
orders <- tibble::tibble(
  order_id = 1:5,
  customer_id = c(1L, 2L, 1L, 3L, 2L),
  amount = c(100, 200, 150, 300, 250)
)

customers <- tibble::tibble(
  customer_id = 1:3,
  name = c("Alice", "Bob", "Charlie")
)

# Create dm without keys
my_dm <- dm(orders, customers)
dm_get_all_pks(my_dm)
dm_get_all_fks(my_dm)

# Automatically infer and add keys
my_dm_with_keys <- dm_add_keys_by_name(my_dm)
dm_get_all_pks(my_dm_with_keys)
dm_get_all_fks(my_dm_with_keys)

# Draw the result
dm_draw(my_dm_with_keys)
\dontshow{\}) # examplesIf}
}
\seealso{
Other primary key functions: 
\code{\link{dm_add_pk}()},
\code{\link{dm_add_uk}()},
\code{\link{dm_get_all_pks}()},
\code{\link{dm_get_all_uks}()},
\code{\link{dm_has_pk}()},
\code{\link{dm_rm_pk}()},
\code{\link{dm_rm_uk}()},
\code{\link{enum_pk_candidates}()}

Other foreign key functions: 
\code{\link{dm_add_fk}()},
\code{\link{dm_enum_fk_candidates}()},
\code{\link{dm_get_all_fks}()},
\code{\link{dm_rm_fk}()}
}
\concept{foreign key functions}
\concept{primary key functions}
