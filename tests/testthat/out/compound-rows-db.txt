> weather_subs <- dm_nycflights_small()$weather %>% mutate(row_num = dplyr::
+   row_number())
> weather_1 <- filter(weather_subs, row_num %in% 1:100)
> weather_2 <- filter(weather_subs, row_num %in% 101:200)
> weather_3 <- filter(weather_subs, row_num %in% 51:150)
> weather_4 <- filter(weather_subs, row_num %in% 51:100)
> rows_insert(weather_1, weather_2, by = c("origin", "time_hour"), in_place = FALSE) %>%
+   count()
        n
  <int64>
1     200

> rows_update(weather_1, weather_4, by = c("origin", "time_hour"), in_place = FALSE)
   origin  year month   day  hour  temp  dewp humid wind_dir wind_speed
   <chr>  <int> <int> <int> <int> <dbl> <dbl> <dbl>    <dbl>      <dbl>
 1 EWR     2013     1     1     1  39.0  26.1  59.4      270      10.4 
 2 EWR     2013     1     1     2  39.0  27.0  61.6      250       8.06
 3 EWR     2013     1     1     3  39.0  28.0  64.4      240      11.5 
 4 EWR     2013     1     1     4  39.9  28.0  62.2      250      12.7 
 5 EWR     2013     1     1     5  39.0  28.0  64.4      260      12.7 
 6 EWR     2013     1     1     6  37.9  28.0  67.2      240      11.5 
 7 EWR     2013     1     1     7  39.0  28.0  64.4      240      15.0 
 8 EWR     2013     1     1     8  39.9  28.0  62.2      250      10.4 
 9 EWR     2013     1     1     9  39.9  28.0  62.2      260      15.0 
10 EWR     2013     1     1    10  41    28.0  59.6      260      13.8 
# ... with more rows, and 6 more variables: wind_gust <dbl>, precip <dbl>,
#   pressure <dbl>, visib <dbl>, time_hour <dttm>, row_num <int64>

> rows_upsert(weather_1, weather_3, by = c("origin", "time_hour"), in_place = FALSE)
Error in UseMethod("rows_upsert", x): no applicable method for 'rows_upsert' applied to an object of class "c('tbl_PqConnection', 'tbl_dbi', 'tbl_sql', 'tbl_lazy', 'tbl')"

