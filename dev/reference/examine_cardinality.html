<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Check table relations — examine_cardinality • dm</title><!-- favicons --><link rel="icon" type="image/png" sizes="48x48" href="../favicon-48x48.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Fira_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Check table relations — examine_cardinality"><meta name="description" content="All check_cardinality_...() functions test the following conditions:
Are all rows in x unique?
Are the rows in y a subset of the rows in x?
Does the relation between x and y meet the cardinality requirements?
One row from x must correspond to the requested number of rows in y,
e.g. _0_1 means that there must be zero or one rows in y for each
row in x.


examine_cardinality() also checks the first two points and subsequently determines the type of cardinality.
For convenience, the x_select and y_select arguments allow restricting the check
to a set of key columns without affecting the return value."><meta property="og:description" content="All check_cardinality_...() functions test the following conditions:
Are all rows in x unique?
Are the rows in y a subset of the rows in x?
Does the relation between x and y meet the cardinality requirements?
One row from x must correspond to the requested number of rows in y,
e.g. _0_1 means that there must be zero or one rows in y for each
row in x.


examine_cardinality() also checks the first two points and subsequently determines the type of cardinality.
For convenience, the x_select and y_select arguments allow restricting the check
to a set of key columns without affecting the return value."><meta property="og:image" content="https://dm.cynkra.com/logo.png"><meta name="robots" content="noindex"><script defer data-domain="dm.cynkra.com" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">
    <a href="https://cynkra.com" class="external-link"><img src="https://cynkra.com/assets/img/logo_small.svg" id="cynkra-logo-nav" alt="cynkra"></a>
    <a class="navbar-brand me-2" href="../index.html">dm</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.11.9002</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/dm.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><a class="dropdown-item" href="../articles/howto-dm-theory.html">Introduction to relational data models</a></li>
    <li><a class="dropdown-item" href="../articles/howto-dm-df.html">Create a dm object from data frames</a></li>
    <li><a class="dropdown-item" href="../articles/howto-dm-db.html">Create a dm object from a database</a></li>
    <li><a class="dropdown-item" href="../articles/howto-dm-copy.html">Copy data to and from a database</a></li>
    <li><a class="dropdown-item" href="../articles/howto-dm-rows.html">Insert, update, or remove rows in a database</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../articles/cheatsheet.html">Cheatsheet</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-technical-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Technical articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-technical-articles"><li><a class="dropdown-item" href="../articles/tech-dm-draw.html">Visualizing dm objects</a></li>
    <li><a class="dropdown-item" href="../articles/tech-dm-keyed.html">Manipulating individual tables</a></li>
    <li><a class="dropdown-item" href="../articles/tech-dm-join.html">Joining in relational data models</a></li>
    <li><a class="dropdown-item" href="../articles/tech-dm-filter.html">Filtering in relational data models</a></li>
    <li><a class="dropdown-item" href="../articles/tech-dm-zoom.html">Zooming and manipulating tables</a></li>
    <li><a class="dropdown-item" href="../articles/tech-dm-low-level.html">Model verification - keys, constraints and normalization</a></li>
    <li><a class="dropdown-item" href="../articles/tech-dm-class.html">Class 'dm' and basic operations</a></li>
    <li><a class="dropdown-item" href="../articles/tech-dm-naming.html">Function naming logic</a></li>
    <li><a class="dropdown-item" href="../articles/tech-dm-cdm.html">Migration guide: 'cdm' -&gt; 'dm'</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cynkra/dm/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Check table relations</h1>
      <small class="dont-index">Source: <a href="https://github.com/cynkra/dm/blob/main/R/check-cardinalities.R" class="external-link"><code>R/check-cardinalities.R</code></a></small>
      <div class="d-none name"><code>examine_cardinality.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>All <code>check_cardinality_...()</code> functions test the following conditions:</p><ol><li><p>Are all rows in <code>x</code> unique?</p></li>
<li><p>Are the rows in <code>y</code> a subset of the rows in <code>x</code>?</p></li>
<li><p>Does the relation between <code>x</code> and <code>y</code> meet the cardinality requirements?
One row from <code>x</code> must correspond to the requested number of rows in <code>y</code>,
e.g. <code>_0_1</code> means that there must be zero or one rows in <code>y</code> for each
row in <code>x</code>.</p></li>
</ol><p><code>examine_cardinality()</code> also checks the first two points and subsequently determines the type of cardinality.</p>
<p>For convenience, the <code>x_select</code> and <code>y_select</code> arguments allow restricting the check
to a set of key columns without affecting the return value.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">check_cardinality_0_n</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  x_select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by_position <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">check_cardinality_1_n</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  x_select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by_position <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">check_cardinality_1_1</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  x_select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by_position <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">check_cardinality_0_1</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  x_select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by_position <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">examine_cardinality</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  x_select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  y_select <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  by_position <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Parent table, data frame or lazy table.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Child table, data frame or lazy table.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>These dots are for future extensions and must be empty.</p></dd>


<dt id="arg-x-select-y-select">x_select, y_select<a class="anchor" aria-label="anchor" href="#arg-x-select-y-select"></a></dt>
<dd><p>Key columns to restrict the check, processed with
<code><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">dplyr::select()</a></code>.</p></dd>


<dt id="arg-by-position">by_position<a class="anchor" aria-label="anchor" href="#arg-by-position"></a></dt>
<dd><p>Set to <code>TRUE</code> to ignore column names and match
by position instead.
The default means matching by name, use <code>x_select</code> and/or <code>y_select</code>
to align the names.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>check_cardinality_...()</code> return <code>x</code>, invisibly,
if the check is passed, to support pipes.
Otherwise an error is thrown and the reason for it is explained.</p>
<p><code>examine_cardinality()</code> returns a character variable specifying the type of relationship between the two columns.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>All cardinality functions accept a parent and a child table (<code>x</code> and <code>y</code>).
All rows in <code>x</code> must be unique, and all rows in <code>y</code> must be a subset of the
rows in <code>x</code>.
The <code>x_select</code> and <code>y_select</code> arguments allow restricting the check
to a set of key columns without affecting the return value.
If given, both arguments must refer to the same number of key columns.</p>
<p>The cardinality specifications "0_n", "1_n", "0_1", "1_1" refer to the expected relation that the child table has with the parent table.
"0", "1" and "n" refer to the occurrences of value combinations
in <code>y</code> that correspond to each combination in the
columns of the parent table.
"n" means "more than one" in this context, with no upper limit.</p>
<p><strong>"0_n"</strong>: no restrictions, each row in <code>x</code> has at least 0 and at most
n corresponding occurrences in <code>y</code>.</p>
<p><strong>"1_n"</strong>: each row in <code>x</code> has at least 1 and at most
n corresponding occurrences in <code>y</code>.
This means that there is a "surjective" mapping from the child table
to the parent table, i.e. each parent table row exists at least once in the
child table.</p>
<p><strong>"0_1"</strong>: each row in <code>x</code> has at least 0 and at most
1 corresponding occurrence in <code>y</code>.
This means that there is a "injective" mapping from the child table
to the parent table, i.e. no combination of values in the
parent table columns is addressed multiple times.
But not all parent table rows have to be referred to.</p>
<p><strong>"1_1"</strong>: each row in <code>x</code> occurs exactly once in <code>y</code>.
This means that there is a "bijective" ("injective" AND "surjective") mapping
between the child table and the parent table, i.e. the
sets of rows are identical.</p>
<p>Finally, <code>examine_cardinality()</code> tests for and returns the nature of the relationship
(injective, surjective, bijective, or none of these)
between the two given sets of columns.
If either <code>x</code> is not unique or there are rows in <code>y</code> that are missing from <code>x</code>,
the requirements for a cardinality test is not fulfilled.
No error will be thrown, but
the result will contain the information which prerequisite was violated.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other cardinality functions:
<code><a href="dm_examine_cardinalities.html">dm_examine_cardinalities</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">d1</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d2</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>a <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">4L</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">d3</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>c <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">5L</span><span class="op">)</span>, d <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># This does not pass, `a` is not unique key of d2:</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">check_cardinality_0_n</span><span class="op">(</span><span class="va">d2</span>, <span class="va">d1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in abort_not_unique_key(x_label, orig_names) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   (`a`) not a unique key of `d2`.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Columns are matched by name by default:</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">check_cardinality_0_n</span><span class="op">(</span><span class="va">d1</span>, <span class="va">d3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in check_card_api_impl({ : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   `by_position = FALSE` or `by_position = NULL` require column names in `x` to match those in `y`.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This passes, multiple values in d3$c are allowed:</span></span></span>
<span class="r-in"><span><span class="fu">check_cardinality_0_n</span><span class="op">(</span><span class="va">d1</span>, <span class="va">d2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># This does not pass, injectivity is violated:</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">check_cardinality_1_1</span><span class="op">(</span><span class="va">d1</span>, <span class="va">d3</span>, y_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>a <span class="op">=</span> <span class="va">c</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in abort_not_bijective(y_label, colnames(y)) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1..1 cardinality (bijectivity) is not given: Column (`a`) in table `d3` contains duplicate values.</span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">check_cardinality_0_1</span><span class="op">(</span><span class="va">d1</span>, <span class="va">d3</span>, x_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>c <span class="op">=</span> <span class="va">a</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Error in abort_not_injective(y_label, colnames(y)) : </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0..1 cardinality (injectivity from child table to parent table) is not given: Column (`c`) in table `d3` contains duplicate values.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># What kind of cardinality is it?</span></span></span>
<span class="r-in"><span><span class="fu">examine_cardinality</span><span class="op">(</span><span class="va">d1</span>, <span class="va">d3</span>, x_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>c <span class="op">=</span> <span class="va">a</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "surjective mapping (child: 1 to n -&gt; parent: 1)"</span>
<span class="r-in"><span><span class="fu">examine_cardinality</span><span class="op">(</span><span class="va">d1</span>, <span class="va">d2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "generic mapping (child: 0 to n -&gt; parent: 1)"</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://cynkra.com/about/" class="external-link">Tobias Schieferdecker</a>, <a href="http://krlmlr.info" class="external-link">Kirill Müller</a>, Darko Bergant, <a href="https://www.energie360.ch/de/" class="external-link"><img src="https://cynkra.github.io/dm/reference/figures/energie-72.png" height="16" alt="energie360° AG"></a>, <a href="https://www.cynkra.com" class="external-link"><img src="https://cynkra.github.io/dm/reference/figures/cynkra-72.png" height="16" alt="cynkra GmbH"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>
Sponsored by <a href="https://cynkra.com" class="external-link"><img src="https://cynkra.com/assets/img/logo_small.svg" id="cynkra-logo-footer" alt="cynkra"></a>
</p>
</div>

    </footer></div>





  </body></html>

