<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="dm">
<title>Introduction to relational data models • dm</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to relational data models">
<meta property="og:description" content="dm">
<meta property="og:image" content="https://cynkra.github.io/dm/logo.png">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    <a href="https://cynkra.com" class="external-link"><img src="https://cynkra.github.io/dm/reference/figures/cynkra-72.png" alt="cynkra" id="navbar-logo"></a>
    <a class="navbar-brand me-2" href="../index.html">dm</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.3.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/dm.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorials">Tutorials</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorials">
    <a class="dropdown-item" href="../articles/howto-dm-theory.html">Introduction to relational data models</a>
    <a class="dropdown-item" href="../articles/howto-dm-df.html">Create a dm object from data frames</a>
    <a class="dropdown-item" href="../articles/howto-dm-db.html">Create a dm object from a database</a>
    <a class="dropdown-item" href="../articles/howto-dm-copy.html">Copy data to and from a database</a>
    <a class="dropdown-item" href="../articles/howto-dm-rows.html">Insert, update, or remove rows in a database</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-technical-articles">Technical articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-technical-articles">
    <a class="dropdown-item" href="../articles/tech-dm-join.html">Joining in relational data models</a>
    <a class="dropdown-item" href="../articles/tech-dm-keyed.html">Manipulating individual tables</a>
    <a class="dropdown-item" href="../articles/tech-dm-zoom.html">Zooming and manipulating tables</a>
    <a class="dropdown-item" href="../articles/tech-dm-filter.html">Filtering in relational data models</a>
    <a class="dropdown-item" href="../articles/tech-dm-draw.html">Visualizing dm objects</a>
    <a class="dropdown-item" href="../articles/tech-dm-low-level.html">Model verification - keys, constraints and normalization</a>
    <a class="dropdown-item" href="../articles/tech-dm-class.html">Class 'dm' and basic operations</a>
    <a class="dropdown-item" href="../articles/tech-dm-naming.html">Function naming logic</a>
    <a class="dropdown-item" href="../articles/tech-dm-cdm.html">Migration guide: 'cdm' -&gt; 'dm'</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/cynkra/dm/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Introduction to relational data models</h1>
                        <h4 data-toc-skip class="author">Katharina Brunner</h4>
            
            <h4 data-toc-skip class="date">2022-10-23</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/cynkra/dm/blob/HEAD/vignettes/howto-dm-theory.Rmd" class="external-link"><code>vignettes/howto-dm-theory.Rmd</code></a></small>
      <div class="d-none name"><code>howto-dm-theory.Rmd</code></div>
    </div>

    
    
<p>Computer scientists are familiar with multiple, linked tables. But, because many R users tend to have backgrounds in other disciplines, we present <strong>six important terms in relational data modeling</strong> to help you to jump-start working with {dm}. These terms are:</p>
<ol style="list-style-type: decimal">
<li><a href="#tables">Data Frames and Tables</a></li>
<li><a href="#model">Data Model</a></li>
<li><a href="#pk">Primary Keys</a></li>
<li><a href="#fk">Foreign Keys</a></li>
<li><a href="#referential-integrity">Referential Integrity</a></li>
<li><a href="#normalization">Normalization</a></li>
<li><a href="#relational-databases">Relational Databases</a></li>
</ol>
<div class="section level2">
<h2 id="data-frames-and-tables">1. Data Frames and Tables<a class="anchor" aria-label="anchor" href="#data-frames-and-tables"></a>
</h2>
<p>A data frame is a fundamental data structure in R. Columns represent variables, rows represent observations. In more technical terms, a data frame is a list of variables of identical length and unique row names. If you imagine it visually, the result is a typical table structure. That is why working with data from spreadsheets is so convenient and the users of the popular <a href="https://dplyr.tidyverse.org" class="external-link">{dplyr}</a> package for data wrangling mainly rely on data frames.</p>
<p>The downside is that data frames and flat file systems like spreadsheets can result in bloated tables because they hold many repetitive values. In the worst case, a data frame can contain multiple columns with only a single value different in each row.</p>
<p>This calls for better data organization by utilizing the resemblance between data frames and database tables, which also consist of columns and rows. The elements are just named differently:</p>
<table class="table">
<thead><tr class="header">
<th>Data Frame</th>
<th>Table</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Column</td>
<td>Attribute (or Field)</td>
</tr>
<tr class="even">
<td>Row</td>
<td>Tuple (or Record)</td>
</tr>
</tbody>
</table>
<p>Additionally, number of rows and columns for a data frame are, respectively, analogous to the <em>cardinality</em> and <em>degree</em> of the table.</p>
<p>Relational databases, unlike data frames, do not keep all data in one large table but instead split it into multiple smaller tables. That separation into sub-tables has several advantages:</p>
<ul>
<li>all information is stored only once, avoiding redundancy and conserving memory</li>
<li>all information needs to be updated only once and in one place, improving consistency and avoiding errors that may result from updating (or forgetting to update) the same value in multiple locations</li>
<li>all information is organized by topic and segmented into smaller tables that are easier to handle</li>
</ul>
<p>It is for these reasons that separation of data helps with data quality, and they explain the popularity of relational databases in production-level data management.</p>
<p>The downside of this approach is that it is harder to merge together information from different data sources and to identify which entities refer to the same object, a common task when modeling or plotting data.</p>
<p>Thus, to take full advantage of the relational database approach, an associated <strong>data model</strong> is needed to overcome the challenges that arise when working with multiple tables.</p>
<p>Let’s illustrate this challenge with the data from the <a href="https://github.com/tidyverse/nycflights13" class="external-link"><code>nycflights13</code> dataset</a> that contains detailed information about the 336,776 flights that departed from New York City in 2013. The information is stored in five tables.</p>
<p>Details like the full name of an airport are not available immediately; these can only be obtained by joining or merging the constituent tables, which can result in long and inflated pipe chains full of <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/filter-joins.html" class="external-link">anti_join()</a></code> and other forms of data merging.</p>
<p>In classical {dplyr} notation, you will need three <code><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join()</a></code> calls to merge the <code>flights</code> table gradually to <code>airlines</code>, <code>planes</code>, <code>airports</code>, and <code>weather</code> tables to create one wide data frame.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://cynkra.github.io/dm/">dm</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hadley/nycflights13" class="external-link">nycflights13</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">nycflights13_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">flights</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">airlines</span>, by <span class="op">=</span> <span class="st">"carrier"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">planes</span>, by <span class="op">=</span> <span class="st">"tailnum"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">airports</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"origin"</span> <span class="op">=</span> <span class="st">"faa"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">weather</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"origin"</span>, <span class="st">"time_hour"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">nycflights13_df</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; # A tibble: 336,776 × 48</span></span>
<span><span class="co">#&gt;    year.x month.x day.x dep_time sched_de…¹ dep_d…² arr_t…³ sched…⁴ arr_d…⁵</span></span>
<span><span class="co">#&gt;     &lt;int&gt;   &lt;int&gt; &lt;int&gt;    &lt;int&gt;      &lt;int&gt;   &lt;dbl&gt;   &lt;int&gt;   &lt;int&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1   2013       1     1      517        515       2     830     819      11</span></span>
<span><span class="co">#&gt;  2   2013       1     1      533        529       4     850     830      20</span></span>
<span><span class="co">#&gt;  3   2013       1     1      542        540       2     923     850      33</span></span>
<span><span class="co">#&gt;  4   2013       1     1      544        545      -1    1004    1022     -18</span></span>
<span><span class="co">#&gt;  5   2013       1     1      554        600      -6     812     837     -25</span></span>
<span><span class="co">#&gt;  6   2013       1     1      554        558      -4     740     728      12</span></span>
<span><span class="co">#&gt;  7   2013       1     1      555        600      -5     913     854      19</span></span>
<span><span class="co">#&gt;  8   2013       1     1      557        600      -3     709     723     -14</span></span>
<span><span class="co">#&gt;  9   2013       1     1      557        600      -3     838     846      -8</span></span>
<span><span class="co">#&gt; 10   2013       1     1      558        600      -2     753     745       8</span></span>
<span><span class="co">#&gt; # … with 336,766 more rows, 39 more variables: carrier &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   flight &lt;int&gt;, tailnum &lt;chr&gt;, origin &lt;chr&gt;, dest &lt;chr&gt;, air_time &lt;dbl&gt;,</span></span>
<span><span class="co">#&gt; #   distance &lt;dbl&gt;, hour.x &lt;dbl&gt;, minute &lt;dbl&gt;, time_hour &lt;dttm&gt;,</span></span>
<span><span class="co">#&gt; #   name.x &lt;chr&gt;, year.y &lt;int&gt;, type &lt;chr&gt;, manufacturer &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   model &lt;chr&gt;, engines &lt;int&gt;, seats &lt;int&gt;, speed &lt;int&gt;, engine &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   name.y &lt;chr&gt;, lat &lt;dbl&gt;, lon &lt;dbl&gt;, alt &lt;dbl&gt;, tz &lt;dbl&gt;, dst &lt;chr&gt;,</span></span>
<span><span class="co">#&gt; #   tzone &lt;chr&gt;, year &lt;int&gt;, month.y &lt;int&gt;, day.y &lt;int&gt;, hour.y &lt;int&gt;, …</span></span></code></pre>
<p>{dm} offers a more elegant and shorter way to combine tables while augmenting {dplyr}/{dbplyr} workflows.</p>
<p>It is possible to have the best of both worlds: manage your data with {dm} as linked tables, and, when necessary, flatten multiple tables into a single data frame for analysis with {dplyr}.</p>
<p>The next step is to create a <a href="#model">data model</a> based on multiple tables:</p>
</div>
<div class="section level2">
<h2 id="model">2. Data Model<a class="anchor" aria-label="anchor" href="#model"></a>
</h2>
<p>A data model shows the structure between multiple tables that are linked together.</p>
<p>The <code>nycflights13</code> relations can be transferred into the following graphical representation:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/dm_nycflights13.html">dm_nycflights13</a></span><span class="op">(</span>cycle <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/dm_draw.html">dm_draw</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<?xml version="1.0" encoding="UTF-8" standalone="no"?><!-- Generated by graphviz version 2.40.1 (20161225.0304)
 --><!-- Title: %0 Pages: 1 --><svg width="250pt" height="230pt" viewbox="0.00 0.00 250.00 230.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 226)"><title>%0</title>
<g id="a_graph0"><a xlink:title="Data Model">
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-226 246,-226 246,4 -4,4"></polygon></a>
</g><!-- airlines --><g id="airlines" class="node"><title>airlines</title>
<polygon fill="#ed7d31" stroke="transparent" points="168.5,-201 168.5,-221 213.5,-221 213.5,-201 168.5,-201"></polygon><text text-anchor="start" x="170.3969" y="-206.4" font-family="Times,serif" font-size="14.00" fill="#ffffff">airlines</text><polygon fill="#fbe5d5" stroke="transparent" points="168.5,-181 168.5,-201 213.5,-201 213.5,-181 168.5,-181"></polygon><text text-anchor="start" x="170.5" y="-187.4" font-family="Times,serif" text-decoration="underline" font-size="14.00" fill="#444444">carrier</text><polygon fill="none" stroke="#9e5320" stroke-opacity="0.666667" points="167,-180 167,-222 214,-222 214,-180 167,-180"></polygon></g><!-- airports --><g id="airports" class="node"><title>airports</title>
<polygon fill="#ed7d31" stroke="transparent" points="167.5,-81 167.5,-101 213.5,-101 213.5,-81 167.5,-81"></polygon><text text-anchor="start" x="169.1192" y="-86.4" font-family="Times,serif" font-size="14.00" fill="#ffffff">airports</text><polygon fill="#fbe5d5" stroke="transparent" points="167.5,-61 167.5,-81 213.5,-81 213.5,-61 167.5,-61"></polygon><text text-anchor="start" x="169.5" y="-67.4" font-family="Times,serif" text-decoration="underline" font-size="14.00" fill="#444444">faa</text><polygon fill="none" stroke="#9e5320" stroke-opacity="0.666667" points="166.5,-60 166.5,-102 214.5,-102 214.5,-60 166.5,-60"></polygon></g><!-- flights --><g id="flights" class="node"><title>flights</title>
<polygon fill="#5b9bd5" stroke="transparent" points="1.5,-141 1.5,-161 102.5,-161 102.5,-141 1.5,-141"></polygon><text text-anchor="start" x="34.1115" y="-146.4" font-family="Times,serif" font-size="14.00" fill="#ffffff">flights</text><polygon fill="#deebf6" stroke="transparent" points="1.5,-121 1.5,-141 102.5,-141 102.5,-121 1.5,-121"></polygon><text text-anchor="start" x="3.5" y="-126.4" font-family="Times,serif" font-size="14.00" fill="#444444">carrier</text><polygon fill="#deebf6" stroke="transparent" points="1.5,-101 1.5,-121 102.5,-121 102.5,-101 1.5,-101"></polygon><text text-anchor="start" x="3.5" y="-106.4" font-family="Times,serif" font-size="14.00" fill="#444444">tailnum</text><polygon fill="#deebf6" stroke="transparent" points="1.5,-81 1.5,-101 102.5,-101 102.5,-81 1.5,-81"></polygon><text text-anchor="start" x="3.5" y="-86.4" font-family="Times,serif" font-size="14.00" fill="#444444">origin</text><polygon fill="#deebf6" stroke="transparent" points="1.5,-61 1.5,-81 102.5,-81 102.5,-61 1.5,-61"></polygon><text text-anchor="start" x="3.5" y="-66.4" font-family="Times,serif" font-size="14.00" fill="#444444">dest</text><polygon fill="#deebf6" stroke="transparent" points="1.5,-41 1.5,-61 102.5,-61 102.5,-41 1.5,-41"></polygon><text text-anchor="start" x="3.0056" y="-46.4" font-family="Times,serif" font-size="14.00" fill="#444444">origin, time_hour</text><polygon fill="none" stroke="#3c678e" stroke-opacity="0.666667" points="0,-40 0,-162 103,-162 103,-40 0,-40"></polygon></g><!-- flights&#45;&gt;airlines --><g id="flights_1" class="edge"><title>flights:carrier-&gt;airlines:carrier</title>
<path fill="none" stroke="#555555" d="M102.5,-131C126.5668,-131 120.8029,-155.2496 139,-171 147.7956,-178.613 151.0394,-185.8305 158.4157,-189.1277"></path><polygon fill="#555555" stroke="#555555" points="158.0291,-192.6157 168.5,-191 159.307,-185.7333 158.0291,-192.6157"></polygon></g><!-- flights&#45;&gt;airports --><g id="flights_2" class="edge"><title>flights:origin-&gt;airports:faa</title>
<path fill="none" stroke="#555555" d="M102.5,-91C128.9473,-91 135.7361,-75.6875 157.2687,-71.8594"></path><polygon fill="#555555" stroke="#555555" points="157.8281,-75.3248 167.5,-71 157.2421,-68.3494 157.8281,-75.3248"></polygon></g><!-- flights&#45;&gt;airports --><g id="flights_3" class="edge"><title>flights:dest-&gt;airports:faa</title>
<path fill="none" stroke="#555555" d="M102.5,-71C127.6649,-71 136.3891,-71 157.3154,-71"></path><polygon fill="#555555" stroke="#555555" points="157.5,-74.5001 167.5,-71 157.5,-67.5001 157.5,-74.5001"></polygon></g><!-- planes --><g id="planes" class="node"><title>planes</title>
<polygon fill="#ed7d31" stroke="transparent" points="167.5,-141 167.5,-161 213.5,-161 213.5,-141 167.5,-141"></polygon><text text-anchor="start" x="172.6178" y="-146.4" font-family="Times,serif" font-size="14.00" fill="#ffffff">planes</text><polygon fill="#fbe5d5" stroke="transparent" points="167.5,-121 167.5,-141 213.5,-141 213.5,-121 167.5,-121"></polygon><text text-anchor="start" x="169.1115" y="-127.4" font-family="Times,serif" text-decoration="underline" font-size="14.00" fill="#444444">tailnum</text><polygon fill="none" stroke="#9e5320" stroke-opacity="0.666667" points="166.5,-120 166.5,-162 214.5,-162 214.5,-120 166.5,-120"></polygon></g><!-- flights&#45;&gt;planes --><g id="flights_4" class="edge"><title>flights:tailnum-&gt;planes:tailnum</title>
<path fill="none" stroke="#555555" d="M102.5,-111C128.9473,-111 135.7361,-126.3125 157.2687,-130.1406"></path><polygon fill="#555555" stroke="#555555" points="157.2421,-133.6506 167.5,-131 157.8281,-126.6752 157.2421,-133.6506"></polygon></g><!-- weather --><g id="weather" class="node"><title>weather</title>
<polygon fill="#70ad47" stroke="transparent" points="140.5,-21 140.5,-41 241.5,-41 241.5,-21 140.5,-21"></polygon><text text-anchor="start" x="168.8492" y="-26.4" font-family="Times,serif" font-size="14.00" fill="#ffffff">weather</text><polygon fill="#e2eeda" stroke="transparent" points="140.5,-1 140.5,-21 241.5,-21 241.5,-1 140.5,-1"></polygon><text text-anchor="start" x="142.0056" y="-7.4" font-family="Times,serif" text-decoration="underline" font-size="14.00" fill="#444444">origin, time_hour</text><polygon fill="none" stroke="#4a732f" stroke-opacity="0.666667" points="139,0 139,-42 242,-42 242,0 139,0"></polygon></g><!-- flights&#45;&gt;weather --><g id="flights_5" class="edge"><title>flights:origin, time_hour-&gt;weather:origin, time_hour</title>
<path fill="none" stroke="#555555" d="M102.5,-51C122.8065,-51 118.7241,-23.5684 130.6469,-14.1387"></path><polygon fill="#555555" stroke="#555555" points="132.0341,-17.3702 140.5,-11 129.9094,-10.7004 132.0341,-17.3702"></polygon></g></g></svg><p>The <code>flights</code> table is linked to four other tables: <code>airlines</code>, <code>planes</code>, <code>weather</code>, and <code>airports</code>. By using directed arrows, the visualization shows explicitly the connection between different columns (they are called attributes in the relational data sphere).</p>
<p>For example: The column <code>carrier</code> in <code>flights</code> can be joined with the column <code>carrier</code> from the <code>airlines</code> table.</p>
<p>The links between the tables are established through <a href="#pk">primary keys</a> and <a href="#fk">foreign keys</a>.</p>
<p>As an aside, we can also now see how avoiding redundant data by building data models with multiple tables can save memory compared to storing data in single a data frame:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">dm</span><span class="op">)</span></span>
<span><span class="co">#&gt; 469680 bytes</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">nycflights13_df</span><span class="op">)</span></span>
<span><span class="co">#&gt; 108020824 bytes</span></span></code></pre></div>
<p>Further Reading: The {dm} methods for <a href="https://cynkra.github.io/dm/articles/tech-dm-draw.html">visualizing data models</a>.</p>
</div>
<div class="section level2">
<h2 id="pk">3. Primary Keys<a class="anchor" aria-label="anchor" href="#pk"></a>
</h2>
<p>In a relational data model, each table should have <strong>one or several columns that uniquely identify a row</strong>. These columns define the <em>primary key</em> (abbreviated with “pk”). If the key consists of a single column, it is called a <em>simple key</em>. A key consisting of more than one column is called a <em>compound key</em>.</p>
<p>Example: In the <code>airlines</code> table of <code>nycflights13</code> the column <code>carrier</code> is the primary key, a simple key. The <code>weather</code> table has the combination of <code>origin</code> and <code>time_hour</code> as primary key, a compound key.</p>
<p>You can get all primary keys in a <code>dm</code> by calling <code><a href="../reference/dm_get_all_pks.html">dm_get_all_pks()</a></code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/dm_get_all_pks.html">dm_get_all_pks</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; # A tibble: 4 × 2</span></span>
<span><span class="co">#&gt;   table    pk_col           </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;keys&gt;           </span></span>
<span><span class="co">#&gt; 1 airlines carrier          </span></span>
<span><span class="co">#&gt; 2 airports faa              </span></span>
<span><span class="co">#&gt; 3 planes   tailnum          </span></span>
<span><span class="co">#&gt; 4 weather  origin, time_hour</span></span></code></pre>
<p><code><a href="../reference/dm_enum_pk_candidates.html">dm_enum_pk_candidates()</a></code> checks suitability of each column to serve as a simple primary key:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/dm_enum_pk_candidates.html">dm_enum_pk_candidates</a></span><span class="op">(</span><span class="va">airports</span><span class="op">)</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; # A tibble: 8 × 3</span></span>
<span><span class="co">#&gt;   columns candidate why                                                    </span></span>
<span><span class="co">#&gt;   &lt;keys&gt;  &lt;lgl&gt;     &lt;chr&gt;                                                  </span></span>
<span><span class="co">#&gt; 1 faa     TRUE      ""                                                     </span></span>
<span><span class="co">#&gt; 2 name    TRUE      ""                                                     </span></span>
<span><span class="co">#&gt; 3 lat     TRUE      ""                                                     </span></span>
<span><span class="co">#&gt; 4 lon     TRUE      ""                                                     </span></span>
<span><span class="co">#&gt; 5 alt     FALSE     "has duplicate values: 30 (4), 13 (3), 9 (2), 19 (2), …</span></span>
<span><span class="co">#&gt; 6 tz      FALSE     "has duplicate values: -5 (48), -6 (21), -8 (12), -7 (…</span></span>
<span><span class="co">#&gt; 7 dst     FALSE     "has duplicate values: A (84), N (2)"                  </span></span>
<span><span class="co">#&gt; 8 tzone   FALSE     "has duplicate values: America/New_York (48), America/…</span></span></code></pre>
<p>Further Reading: The {dm} package offers several functions for dealing with <a href="https://cynkra.github.io/dm/articles/tech-dm-class.html#pk">primary keys</a>.</p>
</div>
<div class="section level2">
<h2 id="fk">4. Foreign Keys<a class="anchor" aria-label="anchor" href="#fk"></a>
</h2>
<p>The <strong>counterpart of a primary key in one table is the foreign key in another table</strong>. In order to join two tables, the primary key of the first table needs to be referenced from the second table. This column or these columns are called the <em>foreign key</em> (abbreviated with “fk”).</p>
<p>For example, if you want to link the <code>airlines</code> table to the <code>flights</code> table, the primary key in <code>airlines</code> needs to match the foreign key in <code>flights</code>. This condition is satisfied because the column <code>carrier</code> is present as a primary key in the <code>airlines</code> table as well as a foreign key in the <code>flights</code> table. In the case of compound keys, the <code>origin</code> and <code>time_hour</code> columns (which form the primary key of the <code>weather</code> table) are also present in the <code>flights</code> table.</p>
<p>You can find foreign key candidates for simple keys with the function <code><a href="../reference/dm_enum_fk_candidates.html">dm_enum_fk_candidates()</a></code>; they are marked with <code>TRUE</code> in the <code>candidate</code> column.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/dm_enum_fk_candidates.html">dm_enum_fk_candidates</a></span><span class="op">(</span><span class="va">flights</span>, <span class="va">airlines</span><span class="op">)</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; # A tibble: 19 × 3</span></span>
<span><span class="co">#&gt;    columns        candidate why                                            </span></span>
<span><span class="co">#&gt;    &lt;keys&gt;         &lt;lgl&gt;     &lt;chr&gt;                                          </span></span>
<span><span class="co">#&gt;  1 carrier        TRUE      ""                                             </span></span>
<span><span class="co">#&gt;  2 year           FALSE     "Can't combine `value1` &lt;integer&gt; and `value1`…</span></span>
<span><span class="co">#&gt;  3 month          FALSE     "Can't combine `value1` &lt;integer&gt; and `value1`…</span></span>
<span><span class="co">#&gt;  4 day            FALSE     "Can't combine `value1` &lt;integer&gt; and `value1`…</span></span>
<span><span class="co">#&gt;  5 dep_time       FALSE     "Can't combine `value1` &lt;integer&gt; and `value1`…</span></span>
<span><span class="co">#&gt;  6 sched_dep_time FALSE     "Can't combine `value1` &lt;integer&gt; and `value1`…</span></span>
<span><span class="co">#&gt;  7 dep_delay      FALSE     "Can't combine `value1` &lt;double&gt; and `value1` …</span></span>
<span><span class="co">#&gt;  8 arr_time       FALSE     "Can't combine `value1` &lt;integer&gt; and `value1`…</span></span>
<span><span class="co">#&gt;  9 sched_arr_time FALSE     "Can't combine `value1` &lt;integer&gt; and `value1`…</span></span>
<span><span class="co">#&gt; 10 arr_delay      FALSE     "Can't combine `value1` &lt;double&gt; and `value1` …</span></span>
<span><span class="co">#&gt; 11 flight         FALSE     "Can't combine `value1` &lt;integer&gt; and `value1`…</span></span>
<span><span class="co">#&gt; 12 tailnum        FALSE     "values of `flights$tailnum` not in `airlines$…</span></span>
<span><span class="co">#&gt; 13 origin         FALSE     "values of `flights$origin` not in `airlines$c…</span></span>
<span><span class="co">#&gt; 14 dest           FALSE     "values of `flights$dest` not in `airlines$car…</span></span>
<span><span class="co">#&gt; 15 air_time       FALSE     "Can't combine `value1` &lt;double&gt; and `value1` …</span></span>
<span><span class="co">#&gt; 16 distance       FALSE     "Can't combine `value1` &lt;double&gt; and `value1` …</span></span>
<span><span class="co">#&gt; 17 hour           FALSE     "Can't combine `value1` &lt;double&gt; and `value1` …</span></span>
<span><span class="co">#&gt; 18 minute         FALSE     "Can't combine `value1` &lt;double&gt; and `value1` …</span></span>
<span><span class="co">#&gt; 19 time_hour      FALSE     "Can't combine `value1` &lt;datetime&lt;America/New_…</span></span></code></pre>
<p>Additionally, you can also extract a summary of all foreign key relations present in a <code>dm</code> object using <code><a href="../reference/dm_get_all_fks.html">dm_get_all_fks()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/dm_get_all_fks.html">dm_get_all_fks</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; # A tibble: 5 × 5</span></span>
<span><span class="co">#&gt;   child_table child_fk_cols     parent_table parent_key_cols   on_delete</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;       &lt;keys&gt;            &lt;chr&gt;        &lt;keys&gt;            &lt;chr&gt;    </span></span>
<span><span class="co">#&gt; 1 flights     carrier           airlines     carrier           no_action</span></span>
<span><span class="co">#&gt; 2 flights     origin            airports     faa               no_action</span></span>
<span><span class="co">#&gt; 3 flights     dest              airports     faa               no_action</span></span>
<span><span class="co">#&gt; 4 flights     tailnum           planes       tailnum           no_action</span></span>
<span><span class="co">#&gt; 5 flights     origin, time_hour weather      origin, time_hour no_action</span></span></code></pre>
<p>Further Reading: All {dm} functions for working with <a href="https://cynkra.github.io/dm/articles/tech-dm-class.html#foreign-keys">foreign keys</a>.</p>
</div>
<div class="section level2">
<h2 id="referential-integrity">5. Referential Integrity<a class="anchor" aria-label="anchor" href="#referential-integrity"></a>
</h2>
<p>A data set has referential integrity if all relations between tables are valid. That is, every foreign key holds a primary key that is present in the parent table. If a foreign key contains a reference where the corresponding row in the parent table is not available, that row is an orphan row and the database no longer has referential integrity.</p>
<p>{dm} allows checking referential integrity with the <code><a href="../reference/dm_examine_constraints.html">dm_examine_constraints()</a></code> function. The following conditions are checked:</p>
<ul>
<li>All primary key values must be unique and not missing (i.e., <code>NA</code>s are not allowed).</li>
<li>Each foreign key value must have a corresponding primary key value.</li>
</ul>
<p>In the example data model, for a substantial share of the flights, detailed information for the corresponding airplane is not available:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dm</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/dm_examine_constraints.html">dm_examine_constraints</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre class="fansi fansi-message"><code><span><span class="co">#&gt; ! Unsatisfied constraints:</span></span></code></pre>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; • Table `flights`: foreign key `dest` into table `airports`: values of `flights$dest` not in `airports$faa`: SJU (30), BQN (6), STT (4), PSE (2)</span></span>
<span><span class="co">#&gt; • Table `flights`: foreign key `tailnum` into table `planes`: values of `flights$tailnum` not in `planes$tailnum`: N725MQ (6), N537MQ (5), N722MQ (5), N730MQ (5), N736MQ (5), …</span></span></code></pre>
<p>Establishing referential integrity is important for providing clean data for analysis or downstream users. See <code><a href="../articles/howto-dm-rows.html">vignette("howto-dm-rows")</a></code> for more information on adding, deleting, or updating individual rows, and <code><a href="../articles/tech-dm-zoom.html">vignette("tech-dm-zoom")</a></code> for operations on the data in a data model.</p>
</div>
<div class="section level2">
<h2 id="normalization">6. Normalization<a class="anchor" aria-label="anchor" href="#normalization"></a>
</h2>
<p>Normalization is a technical term that describes the <strong>central design principle of a relational data model</strong>: splitting data into multiple tables.</p>
<p>A normalized data schema consists of several relations (tables) that are linked with attributes (columns). The relations can be joined together by means of <a href="#pk">primary</a> and <a href="#fk">foreign keys</a>. The main goal of normalization is to keep data organization as clean and simple as possible by avoiding redundant data entries.</p>
<p>For example, if you want to change the name of one airport in the <code>nycflights13</code> dataset, you will only need to update a single data value. This principle is sometimes called the <em>single point of truth</em>.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#  Update in one single location...</span></span>
<span><span class="va">airlines</span><span class="op">[</span><span class="va">airlines</span><span class="op">$</span><span class="va">carrier</span> <span class="op">==</span> <span class="st">"UA"</span>, <span class="st">"name"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="st">"United broke my guitar"</span></span>
<span></span>
<span><span class="va">airlines</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">carrier</span> <span class="op">==</span> <span class="st">"UA"</span><span class="op">)</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span><span class="co">#&gt;   carrier name                  </span></span>
<span><span class="co">#&gt;   &lt;chr&gt;   &lt;chr&gt;                 </span></span>
<span><span class="co">#&gt; 1 UA      United broke my guitar</span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># ...propagates to all related records</span></span>
<span><span class="va">flights</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">airlines</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">flight</span>, <span class="va">name</span><span class="op">)</span></span></code></pre></div>
<pre class="fansi fansi-message"><code><span><span class="co">#&gt; Joining, by = "carrier"</span></span></code></pre>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; # A tibble: 336,776 × 2</span></span>
<span><span class="co">#&gt;    flight name                    </span></span>
<span><span class="co">#&gt;     &lt;int&gt; &lt;chr&gt;                   </span></span>
<span><span class="co">#&gt;  1   1545 United broke my guitar  </span></span>
<span><span class="co">#&gt;  2   1714 United broke my guitar  </span></span>
<span><span class="co">#&gt;  3   1141 American Airlines Inc.  </span></span>
<span><span class="co">#&gt;  4    725 JetBlue Airways         </span></span>
<span><span class="co">#&gt;  5    461 Delta Air Lines Inc.    </span></span>
<span><span class="co">#&gt;  6   1696 United broke my guitar  </span></span>
<span><span class="co">#&gt;  7    507 JetBlue Airways         </span></span>
<span><span class="co">#&gt;  8   5708 ExpressJet Airlines Inc.</span></span>
<span><span class="co">#&gt;  9     79 JetBlue Airways         </span></span>
<span><span class="co">#&gt; 10    301 American Airlines Inc.  </span></span>
<span><span class="co">#&gt; # … with 336,766 more rows</span></span></code></pre>
<p>Another way to demonstrate normalization is splitting a table into two parts.</p>
<p>Let’s look at the <code>planes</code> table, which consists of 3322 individual tail numbers and corresponding information for the specific airplane, like the year it was manufactured or the average cruising speed.</p>
<p>The function <code><a href="../reference/decompose_table.html">decompose_table()</a></code> extracts two new tables and creates a new key <code>model_id</code>, that links both tables.</p>
<p>This results in a <code>parent_table</code> and a <code>child_table</code> that differ massively in the number of rows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">planes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/decompose_table.html">decompose_table</a></span><span class="op">(</span><span class="va">model_id</span>, <span class="va">model</span>, <span class="va">manufacturer</span>, <span class="va">type</span>, <span class="va">engines</span>, <span class="va">seats</span>, <span class="va">speed</span><span class="op">)</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; $child_table</span></span>
<span><span class="co">#&gt; # A tibble: 3,322 × 4</span></span>
<span><span class="co">#&gt;    tailnum  year engine    model_id</span></span>
<span><span class="co">#&gt;    &lt;chr&gt;   &lt;int&gt; &lt;chr&gt;        &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1 N10156   2004 Turbo-fan      120</span></span>
<span><span class="co">#&gt;  2 N102UW   1998 Turbo-fan       93</span></span>
<span><span class="co">#&gt;  3 N103US   1999 Turbo-fan       93</span></span>
<span><span class="co">#&gt;  4 N104UW   1999 Turbo-fan       93</span></span>
<span><span class="co">#&gt;  5 N10575   2002 Turbo-fan      119</span></span>
<span><span class="co">#&gt;  6 N105UW   1999 Turbo-fan       93</span></span>
<span><span class="co">#&gt;  7 N107US   1999 Turbo-fan       93</span></span>
<span><span class="co">#&gt;  8 N108UW   1999 Turbo-fan       93</span></span>
<span><span class="co">#&gt;  9 N109UW   1999 Turbo-fan       93</span></span>
<span><span class="co">#&gt; 10 N110UW   1999 Turbo-fan       93</span></span>
<span><span class="co">#&gt; # … with 3,312 more rows</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $parent_table</span></span>
<span><span class="co">#&gt; # A tibble: 147 × 7</span></span>
<span><span class="co">#&gt;    model_id model       manufacturer     type           engines seats speed</span></span>
<span><span class="co">#&gt;       &lt;int&gt; &lt;chr&gt;       &lt;chr&gt;            &lt;chr&gt;            &lt;int&gt; &lt;int&gt; &lt;int&gt;</span></span>
<span><span class="co">#&gt;  1      120 EMB-145XR   EMBRAER          Fixed wing mu…       2    55    NA</span></span>
<span><span class="co">#&gt;  2       93 A320-214    AIRBUS INDUSTRIE Fixed wing mu…       2   182    NA</span></span>
<span><span class="co">#&gt;  3      119 EMB-145LR   EMBRAER          Fixed wing mu…       2    55    NA</span></span>
<span><span class="co">#&gt;  4       39 737-824     BOEING           Fixed wing mu…       2   149    NA</span></span>
<span><span class="co">#&gt;  5       68 767-332     BOEING           Fixed wing mu…       2   330    NA</span></span>
<span><span class="co">#&gt;  6       52 757-224     BOEING           Fixed wing mu…       2   178    NA</span></span>
<span><span class="co">#&gt;  7       94 A320-214    AIRBUS           Fixed wing mu…       2   182    NA</span></span>
<span><span class="co">#&gt;  8      112 CL-600-2D24 BOMBARDIER INC   Fixed wing mu…       2    95    NA</span></span>
<span><span class="co">#&gt;  9       30 737-724     BOEING           Fixed wing mu…       2   149    NA</span></span>
<span><span class="co">#&gt; 10       27 737-524     BOEING           Fixed wing mu…       2   149    NA</span></span>
<span><span class="co">#&gt; # … with 137 more rows</span></span></code></pre>
<p>While <code>child_table</code> contains 3322 unique <code>tailnum</code> rows and therefore consists of 3322 rows, just like the original <code>planes</code> table, the <code>parent_table</code> shrunk to just 147 rows, enough to store all relevant combinations and avoid storing redundant information.</p>
<p>Further Reading: See the <a href="https://simple.wikipedia.org/wiki/Database_normalisation" class="external-link">Simple English Wikipedia article on database normalization</a> for more details.</p>
</div>
<div class="section level2">
<h2 id="relational-databases">7. Relational Databases<a class="anchor" aria-label="anchor" href="#relational-databases"></a>
</h2>
<p>{dm} is built upon relational data models but it is not a database itself. Databases are systems for data management and many of them are constructed as relational databases (e.g., SQLite, MySQL, MSSQL, Postgres, etc.). As you can guess from the names of the databases, SQL, short for Structured Querying Language, plays an important role: it was invented for the purpose of querying relational databases.</p>
<p>In production, the data is stored in a relational database and {dm} is used to work with the data.</p>
<p>Therefore, {dm} can copy data <a href="https://cynkra.github.io/dm/articles/dm.html#copy">from and to databases</a>, and works transparently with both in-memory data and with relational database systems.</p>
<p>For example, let’s create a local SQLite database and copy the <code>dm</code> object to it:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con_sqlite</span> <span class="op">&lt;-</span> <span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbConnect.html" class="external-link">dbConnect</a></span><span class="op">(</span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu"><a href="https://rsqlite.r-dbi.org/reference/SQLite.html" class="external-link">SQLite</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">con_sqlite</span></span>
<span><span class="co">#&gt; &lt;SQLiteConnection&gt;</span></span>
<span><span class="co">#&gt;   Path: </span></span>
<span><span class="co">#&gt;   Extensions: TRUE</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbListTables.html" class="external-link">dbListTables</a></span><span class="op">(</span><span class="va">con_sqlite</span><span class="op">)</span></span>
<span><span class="co">#&gt; character(0)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/copy_dm_to.html">copy_dm_to</a></span><span class="op">(</span><span class="va">con_sqlite</span>, <span class="va">dm</span><span class="op">)</span></span>
<span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbListTables.html" class="external-link">dbListTables</a></span><span class="op">(</span><span class="va">con_sqlite</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "airlines_1_2020_08_28_07_13_03_12345"</span></span>
<span><span class="co">#&gt; [2] "airports_1_2020_08_28_07_13_03_12345"</span></span>
<span><span class="co">#&gt; [3] "flights_1_2020_08_28_07_13_03_12345" </span></span>
<span><span class="co">#&gt; [4] "planes_1_2020_08_28_07_13_03_12345"  </span></span>
<span><span class="co">#&gt; [5] "weather_1_2020_08_28_07_13_03_12345"</span></span></code></pre></div>
<p>In the opposite direction, <code>dm</code> can also be populated with data from a database. Unfortunately, keys currently can be learned only for Microsoft SQL Server and Postgres, but not for SQLite. Therefore, the <code>dm</code> contains the tables but not the keys:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/dm_from_con.html">dm_from_con</a></span><span class="op">(</span><span class="va">con_sqlite</span><span class="op">)</span></span>
<span><span class="co">#&gt; Keys could not be queried: no such table: information_schema.tables. Use</span></span>
<span><span class="co">#&gt; `learn_keys = FALSE` to mute this message.</span></span></code></pre></div>
<pre class="fansi fansi-output"><code><span><span class="co">#&gt; ── Table source ───────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; src:  sqlite 3.39.4 []</span></span>
<span><span class="co">#&gt; ── Metadata ───────────────────────────────────────────────────────────────</span></span>
<span><span class="co">#&gt; Tables: `airlines_1_2020_08_28_07_13_03_12345`, `airports_1_2020_08_28_07_13_03_12345`, `flights_1_2020_08_28_07_13_03_12345`, `planes_1_2020_08_28_07_13_03_12345`, `weather_1_2020_08_28_07_13_03_12345`</span></span>
<span><span class="co">#&gt; Columns: 53</span></span>
<span><span class="co">#&gt; Primary keys: 0</span></span>
<span><span class="co">#&gt; Foreign keys: 0</span></span></code></pre>
<p>Remember to terminate the database connection:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">DBI</span><span class="fu">::</span><span class="fu"><a href="https://dbi.r-dbi.org/reference/dbDisconnect.html" class="external-link">dbDisconnect</a></span><span class="op">(</span><span class="va">con_sqlite</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In this article, we have learned about some of the most fundamental concepts and data structures associated with the relational database management system (RDBMS).</p>
</div>
<div class="section level2">
<h2 id="further-reading">Further reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<p><code><a href="../articles/howto-dm-db.html">vignette("howto-dm-db")</a></code> – This article covers accessing and working with RDBMSs within your R session, including manipulating data, filling in missing relationships between tables, getting data out of the RDBMS and into your model, and deploying your data model to an RDBMS.</p>
<p><code><a href="../articles/howto-dm-df.html">vignette("howto-dm-df")</a></code> – Is your data in local data frames? This article covers creating a data model from your local data frames, including building the relationships in your data model, verifying your model, and leveraging the power of dplyr to operate on your data model.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Tobias Schieferdecker, <a href="http://krlmlr.info" class="external-link">Kirill Müller</a>, Darko Bergant, <a href="https://www.energie360.ch/de/" class="external-link"><img src="https://cynkra.github.io/dm/reference/figures/energie-72.png" height="16"></a>, <a href="https://www.cynkra.com" class="external-link"><img src="https://cynkra.github.io/dm/reference/figures/cynkra-72.png" height="16"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.9000.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
